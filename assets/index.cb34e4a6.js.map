{"version":3,"file":"index.cb34e4a6.js","sources":["../../src/views/login/index.vue"],"sourcesContent":["<template>\n  <div class=\"form\">\n    <el-form\n      ref=\"ruleForm\"\n      hide-required-asterisk\n      :model=\"modelForm\"\n      :rules=\"rules\"\n      class=\"login-form\"\n      label-position=\"top\"\n    >\n      <h3>系统登录</h3>\n      <el-form-item prop=\"username\" label=\"用户名\">\n        <el-input v-model=\"modelForm.username\" type=\"text\" placeholder=\"请输入账号\"></el-input>\n      </el-form-item>\n      <el-form-item prop=\"password\" label=\"密码\">\n        <el-input\n          v-model=\"modelForm.password\"\n          type=\"password\"\n          name=\"password\"\n          placeholder=\"请输入密码\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button\n          style=\"width: 100%; margin-top: 20px\"\n          type=\"primary\"\n          @click=\"submitForm('ruleForm')\"\n          >登 录</el-button\n        >\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\n  import { defineComponent, getCurrentInstance, reactive, ref, toRefs, watch } from \"vue\"\n  import { useCore } from \"@/core\"\n  import { useUserStore } from \"../../stores\"\n  export default defineComponent({\n    name: \"Login\",\n    setup() {\n      const vm = getCurrentInstance()\n      const { route, router } = useCore()\n      const userStore = useUserStore()\n      const redirect = ref(\"\")\n      const otherQuery = ref({})\n\n      watch(\n        () => route.query.redirect,\n        (v) => {\n          if (v) {\n            redirect.value = v\n            otherQuery.value = getOtherQuery()\n          }\n        },\n        {\n          immediate: true\n        }\n      )\n\n      function getOtherQuery(query) {\n        return query\n      }\n\n      const state = reactive({\n        modelForm: {\n          username: \"admin\",\n          password: \"123456\"\n        },\n        rules: {\n          username: [\n            {\n              required: true,\n              message: \"Please input Activity name\",\n              trigger: \"blur\"\n            }\n          ],\n          password: [\n            {\n              required: true,\n              trigger: \"blur\",\n              message: \"密码不能为空\"\n            }\n          ]\n        }\n      })\n\n      const funcList = {\n        submitForm(formName) {\n          vm.refs[formName].validate((valid) => {\n            if (valid) {\n              userStore\n                .login(state.modelForm)\n                .then((result) => {\n                  console.log(result)\n                  // this.redirect || \"/home\", query: this.otherQuery\n                  router.push({ path: redirect.value || \"/\" })\n                })\n                .catch((err) => {\n                  console.log(err)\n                })\n            } else {\n              console.log(\"error submit!!\")\n              return false\n            }\n          })\n        }\n      }\n\n      return {\n        ...toRefs(state),\n        ...funcList\n      }\n    }\n  })\n</script>\n\n<style lang=\"scss\" scoped>\n  .form {\n    background: $tiffany;\n    height: 100%;\n    box-sizing: border-box;\n    padding-top: 10%;\n\n    .login-form {\n      width: 480px;\n      margin: 0px auto;\n      background-color: #fff;\n      padding: 40px 60px;\n      border-radius: 6px;\n\n      h3 {\n        text-align: center;\n        margin-bottom: 20px;\n        font-size: 20px;\n        font-weight: 500;\n      }\n\n      :deep(.el-form-item) {\n        margin-bottom: 10px;\n      }\n\n      :deep(.el-form-item__label) {\n        line-height: inherit;\n      }\n    }\n  }\n</style>\n"],"names":["defineComponent","name","setup","vm","getCurrentInstance","route","router","useCore","userStore","useUserStore","redirect","ref","otherQuery","query","v","value","immediate","state","reactive","modelForm","username","password","rules","required","message","trigger","funcList","submitForm","formName","refs","validate","valid","log","login","then","result","push","path","catch","err","__spreadValues","toRefs","model","_ctx","class","_hoisted_2","prop","type","style"],"mappings":"wgBAsCE,QAAkBA,GAChBC,KAAM,QACNC,cACQC,EAAKC,KACLC,MAAEA,SAAOC,GAAWC,IACpBC,EAAYC,IACZC,EAAWC,EAAI,IACfC,EAAaD,EAAI,OAGrB,IAAMN,EAAMQ,MAAMH,WACjBI,IACKA,MACOC,MAAQD,IACNC,gBAGf,CACEC,WAAW,UAQTC,EAAQC,EAAS,CACrBC,UAAW,CACTC,SAAU,QACVC,SAAU,UAEZC,MAAO,CACLF,SAAU,CACR,CACEG,UAAU,EACVC,QAAS,6BACTC,QAAS,SAGbJ,SAAU,CACR,CACEE,UAAU,EACVE,QAAS,OACTD,QAAS,cAMXE,EAAW,CACfC,WAAWC,KACNC,KAAKD,GAAUE,UAAUC,QACtBA,iBAYMC,IAAI,mBACL,IAXJC,MAAMhB,EAAME,WACZe,MAAMC,YACGH,IAAIG,KAELC,KAAK,CAAEC,KAAM3B,EAASK,OAAS,SAEvCuB,OAAOC,YACEP,IAAIO,kBAUjBC,OACFC,EAAOxB,IACPS,yBA9GJ,iOAGDf,eACC,4BACA+B,MAAOC,YACRrB,MAAMqB,QACNC,4DAGAC,OAA8BC,mFACW,6DAAYC,sEAEvBD,kFAG1B,6DACAC,KAAK,WACL9C,oGAMA+C,yCACCD"}